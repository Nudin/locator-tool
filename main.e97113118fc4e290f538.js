webpackJsonp([1,3],{100:function(t,e,o){"use strict";var a=o(136),i=o.n(a),n=function(t,e,o){Object.assign(this,{ltData:t,$state:e,categoryDepth:void 0!==o.categoryDepth?parseInt(o.categoryDepth):3,titles:""}),console.log(this.categoryDepth,o.categoryDepth),o.user?(this.user=o.user,this.getFilesForUser()):o.category&&(this.category=o.category,this.getFilesForCategory())},l={titleList:{}};n.prototype.getCategoriesForPrefix=function(){var t=this;this.ltData.getCategoriesForPrefix(this.category).then(function(e){t.categorySuggestions=e})},n.prototype.getFilesForUser=function(){var t=this;this.$state.go(".",{user:this.user,category:void 0},{replace:!0}),this.getFilesForUser$q=this.ltData.getFilesForUser(this.user).then(function(e){t.titleList=e})},n.prototype.getFilesForCategory=function(){var t=this;this.$state.go(".",{category:this.category,user:void 0},{replace:!0}),this.getFilesForCategory$q=this.ltData.getFilesForCategory(this.category,this.categoryDepth).then(function(e){t.titleList=e})},n.prototype.next=function(){var t=this.titleList.join("|");this.$state.go("geolocate",{files:t})},l.titleList.get=function(){return this.titles.split("\n").map(function(t){return t&&t.split("|")[0]}).filter(function(t){return t})},l.titleList.set=function(t){this.titles=t&&t.join("\n")},Object.defineProperties(n.prototype,l),n.$inject=["ltData","$state","$stateParams"],e.a={template:i.a,controller:n}},101:function(t,e,o){"use strict";var a=o(137),i=o.n(a),n=o(77),l=(o.n(n),o(78)),r=(o.n(l),function(t,e,o,a){var i=this;Object.assign(this,{$window:t,localStorageService:e,gettext:o,gettextCatalog:a}),this.languages={de:this.getDisplayString("de"),en:"English",fr:this.getDisplayString("fr")};var n=e.get("language");if(n)a.setCurrentLanguage(n);else if(t.navigator&&t.navigator.languages){var l=t.navigator.languages.filter(function(t){return i.languages[t]});l.length&&a.setCurrentLanguage(l[0])}}),s={language:{}};s.language.get=function(){return this.gettextCatalog.getCurrentLanguage()},s.language.set=function(t){this.localStorageService.set("language",t),this.gettextCatalog.setCurrentLanguage(t)},r.prototype.getDisplayString=function(t){var e=this.gettext("LANGUAGE");return this.gettextCatalog.getStringFormFor(t,e,1)||t},Object.defineProperties(r.prototype,s),r.$inject=["$window","localStorageService","gettext","gettextCatalog"],e.a={template:i.a,controller:r}},102:function(t,e,o){"use strict";e.a={bindings:{type:"@",latLng:"<"},template:["<code>{{",'<span>{{$ctrl.type || "Location"}}</span>','<span ng-if="$ctrl.latLng"> | {{$ctrl.latLng.lat}} | {{$ctrl.latLng.lng}}</span>',"}}</code>"].join("")}},103:function(t,e,o){"use strict";var a=o(138),i=o.n(a),n=function(t){this.$scope=t};n.prototype.fireChanged=function(t){this.$scope.$emit("coordinatesChanged",t)},n.$inject=["$scope"],e.a={bindings:{latLng:"<",editLocation:"&"},controller:n,template:i.a}},104:function(t,e,o){"use strict";var a=o(139),i=o.n(a),n={lat:51.505,lng:-.09,zoom:13},l=function(t,e,o,a,i,l,r){var s=this;Object.assign(this,{ltData:t,ltDataAuth:a,localStorageService:r}),this.mapView=r.get("mapView")||n;var c=l(function(e,a){o.files&&e(o.files),o.user?t.getFilesForUser(o.user).then(e):o.category?t.getFilesForCategory(o.category,o.categoryDepth).then(e):a()}),g=c.then(t.getCoordinates).then(function(t){s.titles=i("orderBy")(t,"file"),s.showGeolocated=s.titles.length<=5,s.title=s.titles.filter(function(t){return s.showGeolocated||!t.coordinates.lat})[0]});this.loading$q=l.all([c,g]),e.$watch("$ctrl.title",function(t){return s.titleChanged(t)}),e.$watch("$ctrl.mapView",function(t){return s.mapViewChanged(t)},!0),e.$on("coordinatesChanged",function(t,e){return s.coordinatesChanged(e)})},r={titlesDefinedAndSaved:{},titlesDefinedAndSavedPercent:{}};r.titlesDefinedAndSaved.get=function(){return this.titles&&this.titles.filter(function(t){return t.coordinates.isDefinedAndSaved})||[]},r.titlesDefinedAndSavedPercent.get=function(){return 100*this.titlesDefinedAndSaved.length/(this.titles||[]).length},l.prototype.titleChanged=function(t){var e=this;this.error=void 0,t&&t.coordinates&&this.updateMapView(t.coordinates),t&&t.pageid&&this.ltData.getObjectLocation(t.pageid).then(function(o){var a=o.lat,i=o.lng;t.objectLocation=o,t.coordinates&&t.coordinates.lat||e.updateMapView({lat:a,lng:i})})},l.prototype.mapViewChanged=function(t){this.localStorageService.set("mapView",t)},l.prototype.updateMapView=function(t){var e=t.lat,o=t.lng;e&&o&&Object.assign(this.mapView,{lat:e,lng:o})},l.prototype.coordinatesChanged=function(t){t&&("Location"===t.type?this.title.coordinates=this.title.coordinates.withLatLng(t):"Object location"===t.type&&(this.title.objectLocation=this.title.objectLocation.withLatLng(t)))},Object.defineProperties(l.prototype,r),l.$inject=["ltData","$scope","$stateParams","ltDataAuth","$filter","$q","localStorageService"],e.a={template:i.a,controller:l}},105:function(t,e,o){"use strict";function a(t,e){return void 0===e&&(e=1e8),t*e%1?Math.round(t*e)/e:t}var i,n=o(140),l=o.n(n),r=function(t,e){Object.assign(this,{$scope:t,localStorageService:e}),i=this.localStorageService.get("mapLayer")||"OSM"};r.prototype.mapInit=function(t,e){var o='<a href="https://www.openstreetmap.org/copyright" target="_blank">\n      OpenStreetMap</a> contributors',a=t.tileLayer("https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}.png",{maxZoom:18,attribution:"Wikimedia maps | Map data &copy; "+o}),n=t.tileLayer("https://tiles.wmflabs.org/osm/{z}/{x}/{y}.png",{maxZoom:18,attribution:o}),l=t.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,attribution:o}),r={OSM:l,"OSM @wmflabs.org":n,"Wikimedia maps":a};t.control.layers(r).addTo(e),(r[i]||n).addTo(e),new t.Control.GeoSearch({provider:new t.GeoSearch.Provider.OpenStreetMap,showMarker:!1}).addTo(e)},r.prototype.mapClick=function(t){var e=t.latlng,o=e.lat,i=e.lng,n=t.originalEvent.shiftKey;if(o&&i){var l=n?this.mapObjectLocation:this.mapMarker,r=l.withLatLng({lat:a(o),lng:a(i)});this.$scope.$emit("coordinatesChanged",r)}},r.prototype.mapLayerChange=function(t){this.localStorageService.set("mapLayer",t.name)},r.$inject=["$scope","localStorageService"],e.a={bindings:{mapView:"<",mapMarker:"<",mapObjectLocation:"<"},template:l.a,controller:r}},106:function(t,e,o){"use strict";var a=o(133);o.n(a);e.a={template:'\n  <div class="spinner">\n    <div class="bounce1"></div>\n    <div class="bounce2"></div>\n    <div class="bounce3"></div>\n  </div>'}},107:function(t,e,o){"use strict";var a=o(141),i=o.n(a),n=function(t){var e=this;t.getUserInfo().then(function(t){e.user=t})};n.$inject=["ltDataAuth"],e.a={template:i.a,controller:n}},108:function(t,e,o){"use strict";function a(){var t=/([+-]?\d+\.\d*)[,;\s]+([+-]?\d+\.\d*)/;return{require:"ngModel",link:function(e,o,a,n){function l(e){s||(s=n.$modelValue&&n.$modelValue.type);var o=e.match(t);return n.$setValidity("coordinate",o||n.$isEmpty(e)),o||n.$isEmpty(e)?new i.a(s,{lat:o?parseFloat(o[1]):void 0,lng:o?parseFloat(o[2]):void 0}):void 0}function r(t){return t&&t.csv}var s;n.$parsers.push(l),n.$formatters.push(r)}}}var i=o(39);e.a=a},133:function(t,e){},134:function(t,e){t.exports='<h1> <span class="glyphicon glyphicon-map-marker"></span> <span translate>locator-tool</span> </h1> <p translate> This tool helps to add <lt-location></lt-location> information to images on <a href=https://commons.wikimedia.org/ >Wikimedia Commons</a>. </p> <h2 translate>Usage</h2> <ol> <li translate>Log in using the button on the upper right corner</li> <li translate><a ui-sref=select>Select files to geolocate</a> by querying a category or inputting a list of <code>File:</code>s.</li> <li translate>From the list of files provided, select one and click its location on an interactive map.</li> <li translate>Repeat …</li> </ol> <h2 translate>Tutorial</h2> <p translate> → <a href=https://commons.wikimedia.org/wiki/Commons:Locator-tool>Commons:Locator-tool</a> </p> <h2 translate>Edits using locator-tool</h2> <p> → <a href="https://commons.wikimedia.org/w/index.php?title=Special:RecentChanges&amp;tagfilter=OAuth+CID%3A+496" translate>Edits using locator-tool</a> </p> <h2 translate>Translate</h2> <p> → <a href=https://www.transifex.com/locator-tool/locator-tool/ translate>Translate locator-tool on Transifex</a> </p> <h2 translate>About</h2> <p><span translate> This tool has been created by <a href=https://github.com/simon04/ >simon04</a>. </span> <span translate> Its source code is available on <a href=https://github.com/simon04/locator-tool>GitHub</a> and <a href=https://www.gnu.org/licenses/gpl.html>GPL v3</a> licensed. </span></p> '},135:function(t,e){t.exports='<h2> {{$ctrl.title.file}} <small><a href={{$ctrl.title.url}} target=_blank> <span class="glyphicon glyphicon-new-window"></span> </a></small> </h2> <div ng-bind-html=$ctrl.title.description class="well well-sm"></div> <div class=form-group> <label> <lt-location type={{$ctrl.title.coordinates.type}}></lt-location> </label> <lt-location-input lat-lng=$ctrl.title.coordinates edit-location="$ctrl.editLocation($ctrl.title, $ctrl.title.coordinates)"> </lt-location-input> <p translate class=help-block>Left click on map to set the location.</p> </div> <div class=form-group> <label> <lt-location type={{$ctrl.title.objectLocation.type}}></lt-location> </label> <lt-location-input lat-lng=$ctrl.title.objectLocation edit-location="$ctrl.editLocation($ctrl.title, $ctrl.title.objectLocation)"> </lt-location-input> <p translate class=help-block>Press shift and click on map to set the object location.</p> </div> <div class="alert alert-danger" ng-if=$ctrl.error> <span class="glyphicon glyphicon-exclamation-sign" aria-hidden=true></span> <span translate>Failed to save <lt-location></lt-location>!</span> </div> '},136:function(t,e){t.exports='<form class=form-group name=formUser ng-submit=$ctrl.getFilesForUser()> <label for=inputUser translate>User</label> <input id=inputUser class=form-control ng-model=$ctrl.user placeholder=User:…> <input type=submit ng-disabled=!$ctrl.user class="btn btn-default" value="{{\'Fetch files for User\' | translate}}"> <lt-spinner ng-if="$ctrl.getFilesForUser$q && !$ctrl.getFilesForUser$q.$$state.status" style=display:inline-block></lt-spinner> </form> <form class=form-group name=formCategory ng-submit=$ctrl.getFilesForCategory()> <div class=row> <div class=col-md-10> <label for=inputCategory translate>Category</label> <input id=inputCategory list=datalistCategory class=form-control ng-model=$ctrl.category ng-model-options="{updateOn: \'default blur\', debounce: {default: 500, blur: 0}}" ng-change=$ctrl.getCategoriesForPrefix() placeholder=Category:…> </div> <div class=col-md-2> <label for=inputCategoryDepth translate-comment="Depth of category tree" translate-context=Category translate>Depth</label> <input id=inputCategoryDepth type=number class=form-control ng-model=$ctrl.categoryDepth> </div> </div> <input type=submit ng-disabled=!$ctrl.category class="btn btn-default" value="{{\'Fetch files for Category\' | translate}}"> <lt-spinner ng-if="$ctrl.getFilesForCategory$q && !$ctrl.getFilesForCategory$q.$$state.status" style=display:inline-block></lt-spinner> <datalist id=datalistCategory> <option ng-repeat="i in $ctrl.categorySuggestions" ng-value=i /> </datalist> </form> <form class=form-group name=formTitles> <label for=inputTitles translate>Files</label> <textarea id=inputTitles class=form-control rows=10 ng-model=$ctrl.titles placeholder=File:…></textarea> <button ng-disabled=!$ctrl.titleList.length ng-click=$ctrl.next() class="btn btn-default" translate> Geolocate {{$ctrl.titleList.length}} files </button> </form> '},137:function(t,e){t.exports='<select class=form-control ng-model=$ctrl.language> <option ng-repeat="(key, label) in $ctrl.languages" value={{key}}>{{label}}</option> </select> '},138:function(t,e){t.exports='<div class=input-group ng-form=coordinatesForm ng-class="{\'has-error\': !coordinatesForm.$valid}"> <input type=text class=form-control ng-model=$ctrl.latLng ng-model-options="{updateOn: \'default blur\', debounce: {default: 2000, blur: 0}}" ng-change="coordinatesForm.$valid && $ctrl.fireChanged($ctrl.latLng)" smart-coordinate> <span class=input-group-btn> <button class="btn btn-default" type=button ng-click="$ctrl.fireChanged($ctrl.latLng.withLatLng(undefined))" title="{{\'Discard\'|translate}}"> <span class="glyphicon glyphicon-remove"></span> </button> <button class="btn btn-success" type=button ng-click=$ctrl.editLocation() title="{{\'Save\'|translate}}" ng-disabled=!$ctrl.latLng.isChanged> <span class="glyphicon glyphicon-save"></span> </button> </span> </div> '},139:function(t,e){t.exports='<div class="row fill"> <div class="col-md-3 col-lg-2 fill col-md-h40" style=position:relative> <div class=progress> <div class=progress-bar role=progressbar ng-style="{width: $ctrl.titlesDefinedAndSavedPercent + \'%\'}"> {{$ctrl.titlesDefinedAndSaved.length}} / {{$ctrl.titles.length}} </div> </div> <div class=form-group> <div class=checkbox> <label> <input ng-model=$ctrl.showGeolocated type=checkbox> <span translate>Also show geolocated files</span> </label> </div> </div> <div class=input-group> <span class=input-group-addon><span class="glyphicon glyphicon-search"></span></span> <input class=form-control ng-model=$ctrl.filter type=text> </div> <ul class="list-group list-group-files fill-absolute" style=top:110px> <li ng-if="$ctrl.loading$q && !$ctrl.loading$q.$$state.status"><lt-spinner></lt-spinner></li> <li ng-repeat="title in $ctrl.titles | filter:$ctrl.filter" ng-show="$ctrl.showGeolocated || !title.coordinates.isDefinedAndSaved" ng-click="$ctrl.title = title" class=list-group-item ng-class="{\'list-group-item-info\': title === $ctrl.title}"> <span ng-show=title.coordinates.isDefinedAndSaved class="glyphicon glyphicon-check"></span> {{title.file}} </li> </ul> </div> <div class="col-md-9 col-lg-3 fill col-md-h40" ng-if=$ctrl.title style=overflow-y:auto> <div class=row> <div class="col-md-5 col-lg-12"> <lt-file-details title=$ctrl.title></lt-file-details> </div> <div class="col-md-7 col-lg-12"> <img class="img-responsive thumbnail" ng-src={{$ctrl.title.thumbnail}} style=max-height:100%> </div> </div> </div> <div class="col-md-12 col-lg-7 fill col-md-h60" ng-if=$ctrl.title> <lt-map class=fill map-view=$ctrl.mapView map-marker=$ctrl.title.coordinates map-object-location=$ctrl.title.objectLocation></lt-map> </div> </div> '},140:function(t,e){t.exports='<div ll-map ll-init=$ctrl.mapInit class=fill ll-click=$ctrl.mapClick($event) ll-baselayerchange=$ctrl.mapLayerChange($event)> <ll-view ll-view=$ctrl.mapView></ll-view> <ll-marker ll-lat-lng=$ctrl.mapMarker ll-marker="{draggable: true}" ng-if=$ctrl.mapMarker.lat></ll-marker> <ll-marker ll-lat-lng=$ctrl.mapObjectLocation ng-if=$ctrl.mapObjectLocation.lat> <ll-div-icon><div title="Object location"> <span class="glyphicon glyphicon-asterisk" style=color:red></span> </div></ll-div-icon> </ll-marker> </div> '},141:function(t,e){t.exports='<a href="/locator-tool/login?next=/locator-tool/" ng-hide=$ctrl.user class="btn btn-default navbar-btn" translate>Log in</a> <p ng-show=$ctrl.user class=navbar-text translate>Logged in as {{$ctrl.user}}</p> <a href="/locator-tool/logout?next=/locator-tool/" ng-show=$ctrl.user class="btn btn-default navbar-btn" translate>Log out</a> '},156:function(t,e,o){"use strict";function a(t,e){t.state("about",{url:"/",component:"ltAbout"}),t.state("select",{url:"/select?user&category&categoryDepth",component:"ltFilesSelector"}),t.state("geolocate",{url:"/geolocate?files&user&category&categoryDepth",component:"ltMain"}),e.otherwise("/")}Object.defineProperty(e,"__esModule",{value:!0});var i=o(5),n=o.n(i),l=o(23),r=o.n(l),s=o(24),c=o.n(s),g=o(22),u=o.n(g),p=o(68),d=(o.n(p),o(65)),h=o(66);n.a.module("app",[c.a,r.a,u.a,d.a,h.a]),n.a.module("app").config(a),a.$inject=["$stateProvider","$urlRouterProvider"],n.a.element(document).ready(function(){n.a.bootstrap(document,["app"],{strictDi:!0})})},39:function(t,e,o){"use strict";function a(t){return t%1===0?t.toFixed(1):t}var i=function(t,e){var o=e.lat,a=e.lng;Object.assign(this,{type:t,lat:o,lng:a,_latOriginal:o,_lngOriginal:a})},n={isDefined:{},isChanged:{},isDefinedAndSaved:{},csv:{}};i.prototype.withLatLng=function(t){void 0===t&&(t={});var e=t.lat,o=t.lng,a=new i(this.type,{lat:e,lng:o});return a._latOriginal=this._latOriginal,a._lngOriginal=this._lngOriginal,a},i.prototype.markAsSaved=function(){Object.assign(this,{_latOriginal:this.lat,_lngOriginal:this.lng})},n.isDefined.get=function(){return this.lat&&this.lng},n.isChanged.get=function(){return this.lat!==this._latOriginal||this.lng!==this._lngOriginal},n.isDefinedAndSaved.get=function(){return this.isDefined&&!this.isChanged},n.csv.get=function(){return this.isDefined&&[this.lat,this.lng].map(a).join(", ")},Object.defineProperties(i.prototype,n),e.a=i},65:function(t,e,o){"use strict";var a=o(5),i=o.n(a),n=o(96),l=o(97);e.a=i.a.module("app.api",[]).factory("ltData",n.a).factory("ltDataAuth",l.a).name},66:function(t,e,o){"use strict";var a=o(5),i=o.n(a),n=o(37),l=o(98),r=o(99),s=o(100),c=o(101),g=o(102),u=o(103),p=o(104),d=o(105),h=o(106),f=o(107),m=o(108);e.a=i.a.module("app.components",[n.a]).component("ltAbout",l.a).component("ltFileDetails",r.a).component("ltFilesSelector",s.a).component("ltLanguageSelector",c.a).component("ltLocation",g.a).component("ltLocationInput",u.a).component("ltMain",p.a).component("ltMap",d.a).component("ltSpinner",h.a).component("ltUserInfo",f.a).directive("smartCoordinate",m.a).name},68:function(t,e){},77:function(t,e){angular.module("gettext").run(["gettextCatalog",function(t){t.setStrings("de",{'<a ui-sref="select">Select files to geolocate</a> by querying a category or inputting a list of <code>File:</code>s.':'<a ui-sref="select">Dateien zum Georeferenzieren auswählen</a> via Kategorie oder <code>Datei:</code>-Liste.',About:"Über","About locator-tool":"Über locator-tool","Also show geolocated files":"Auch georeferenzierte Dateien anzeigen",Category:"Kategorie",Depth:{Category:"Tiefe"},Discard:"Verwerfen","Edits using locator-tool":"Bearbeitungen mit locator-tool","Failed to save <lt-location></lt-location>!":"<lt-location></lt-location> konnte nicht gespeichert werden!","Fetch files for Category":"Dateien der Kategorie laden","Fetch files for User":"Dateien des Benutzers laden",Files:"Dateien","From the list of files provided, select one and click its location on an interactive map.":"Eine Datei in der Dateiliste auswählen und deren Position durch Klick auf die interaktive Karte auswählen.","Geolocate files":"Dateien georeferenzieren","Geolocate {{$ctrl.titleList.length}} files":"{{$ctrl.titleList.length}} Dateien georeferenzieren",'Its source code is available on <a href="https://github.com/simon04/locator-tool">GitHub</a> and <a href="https://www.gnu.org/licenses/gpl.html">GPL v3</a> licensed.':'Der Quellcode ist auf <a href="https://github.com/simon04/locator-tool">GitHub</a> verfügbar steht unter der Lizenz <a href="https://www.gnu.org/licenses/gpl.html">GPL v3</a>.',LANGUAGE:"Deutsch","Left click on map to set the location.":"Linksklick auf Karte setzt die Position.","Log in":"Anmelden","Log in using the button on the upper right corner":"Anmelden mittels Button im rechten oberen Eck","Log out":"Abmelden","Logged in as {{$ctrl.user}}":"Angemeldet als {{$ctrl.user}}","Press shift and click on map to set the object location.":"Shift-Taste und Klick auf Karte setzt die Objektposition.","Repeat …":"Wiederhole …",Save:"Speichern","Select files to geolocate":"Dateien zum Georeferenzieren auswählen",'This tool has been created by <a href="https://github.com/simon04/">simon04</a>.':'Dieses Werkzeug wurde von <a href="https://github.com/simon04/">simon04</a> entwickelt.','This tool helps to add <lt-location></lt-location> information to images on <a href="https://commons.wikimedia.org/">Wikimedia Commons</a>.':'Dieses Werkzeug hilft <lt-location></lt-location> zu bestehenden Dateien auf <a href="https://commons.wikimedia.org/">Wikimedia Commons</a> hinzuzufügen.',Translate:"Übersetzen","Translate locator-tool on Transifex":"Übersetze locator-tool auf Transifex",Tutorial:"Einführung",Usage:"Verwendung",User:"Benutzer","locator-tool":"locator-tool",'→ <a href="https://commons.wikimedia.org/wiki/Commons:Locator-tool">Commons:Locator-tool</a>':'→ <a href="https://commons.wikimedia.org/wiki/Commons:Locator-tool">Commons:Locator-tool</a>'})}])},78:function(t,e){angular.module("gettext").run(["gettextCatalog",function(t){t.setStrings("fr",{'<a ui-sref="select">Select files to geolocate</a> by querying a category or inputting a list of <code>File:</code>s.':'<a ui-sref="select">Sélectionnez les fichiers à géolocaliser</a> par catégorie ou en entrant une liste de <code>Fichiers:</code>s.',About:"À propos","About locator-tool":"À propos du locator-tool","Also show geolocated files":"Afficher aussi les fichiers géolocalisés",Category:"Catégorie",Depth:{Category:"Profondeur"},Discard:"Effacer","Edits using locator-tool":"Modifications utilisant locator-tool","Failed to save <lt-location></lt-location>!":"Impossible de sauvegarder <lt-location></lt-location> !","Fetch files for Category":"Récupérer par catégorie","Fetch files for User":"Récupérer par utilisateur",Files:"Fichiers","From the list of files provided, select one and click its location on an interactive map.":"Sélectionnez un fichier dans la liste, et cliquez sur son emplacement sur la carte.","Geolocate files":"Géolocaliser les fichiers","Geolocate {{$ctrl.titleList.length}} files":"Géolocaliser {{$ctrl.titleList.length}} fichiers",'Its source code is available on <a href="https://github.com/simon04/locator-tool">GitHub</a> and <a href="https://www.gnu.org/licenses/gpl.html">GPL v3</a> licensed.':'Le code source est sous licence <a href="https://www.gnu.org/licenses/gpl.html">GPL v3</a> et disponible sur <a href="https://github.com/simon04/locator-tool">GitHub</a>.',LANGUAGE:"Français","Left click on map to set the location.":"Clic-gauche sur la carte pour définir l'emplacement","Log in":"Se connecter","Log in using the button on the upper right corner":"Identifiez-vous en utilisant le bouton en haut à droite","Log out":"Se déconnecter","Logged in as {{$ctrl.user}}":"Identifié en tant que {{$ctrl.user}}","Press shift and click on map to set the object location.":"Majuscule+clic gauche sur la carte pour définir l'emplacement","Repeat …":"Répéter…",Save:"Enregistrer","Select files to geolocate":"Sélection des fichiers à géolocaliser",'This tool has been created by <a href="https://github.com/simon04/">simon04</a>.':'Cet outil a été créé par <a href="https://github.com/simon04/">simon04</a>.','This tool helps to add <lt-location></lt-location> information to images on <a href="https://commons.wikimedia.org/">Wikimedia Commons</a>.':"Cet outil permet d'ajouter l'information <lt-location></lt-location> aux images présentes sur <a href=\"https://commons.wikimedia.org/\">Wikimedia Commons</a>.",Translate:"Traduire","Translate locator-tool on Transifex":"Traduire le locator-tool sur Transifex",Tutorial:"Didacticiel",Usage:"Utilisation",User:"Utilisateur","locator-tool":"locator-tool",'→ <a href="https://commons.wikimedia.org/wiki/Commons:Locator-tool">Commons:Locator-tool</a>':'→ <a href="https://commons.wikimedia.org/wiki/Commons:Locator-tool">Commons:Locator-tool</a>'})}])},96:function(t,e,o){"use strict";function a(t,e,o,a){function i(t){if(n.a.isString(t)&&(t=t.split("|")),t.length>d)return r(t);var a={prop:"coordinates|imageinfo",titles:t.join("|"),iiprop:"url|extmetadata",iiurlwidth:1024,iiextmetadatafilter:"ImageDescription"};return p(a).then(function(t){var a=t.data&&t.data.query&&t.data.query.pages||{},i=e("imageinfo[0].extmetadata.ImageDescription.value"),n=e("imageinfo[0].thumburl"),r=e("imageinfo[0].descriptionurl"),s=e("{lat: coordinates[0].lat, lng: coordinates[0].lon}");return Object.keys(a).map(function(t){var e=a[t];return{pageid:parseInt(t),file:e.title,description:o.trustAsHtml(i(e)),thumbnail:n(e),url:r(e),coordinates:new l.a("Location",s(e)),objectLocation:new l.a("Object location",{})}})})}function r(t){function e(t){return t.reduce(function(t,e){return t.concat(e)},[])}for(var o=Object.assign([],t),n=[];o.length;)n.push(o.splice(0,Math.min(d,o.length)));var l=n.map(i);return a.all(l).then(e)}function s(t){var e={prop:"revisions",pageids:t,rvprop:"content"};return p(e).then(function(e){try{var o,a,i=e.data.query.pages[t].revisions[0]["*"],n=i.match(/\{\{Object location( dec)?\|([0-9]+)\|([0-9]+)\|([0-9.]+)\|([NS])\|([0-9]+)\|([0-9]+)\|([0-9.]+)\|([WE])/),r=i.match(/\{\{Object location( dec)?\s*\|\s*([0-9.]+)\s*\|\s*([0-9.]+)/);return n?(o=parseInt(n[2])+parseInt(n[3])/60+parseFloat(n[4])/3600,o*="N"===n[5]?1:-1,a=parseInt(n[6])+parseInt(n[7])/60+parseFloat(n[8])/3600,a*="E"===n[9]?1:-1):r&&(o=parseFloat(r[2]),a=parseFloat(r[3])),new l.a("Object location",{lat:o,lng:a})}catch(t){return new l.a("Object location",{})}})}function c(t){var e={list:"allpages",apnamespace:14,aplimit:30,apfrom:t,apprefix:t};return p(e).then(function(t){return t.data.query.allpages.map(function(t){return t.title.replace(/^Category:/,"")})})}function g(t){var e={list:"usercontribs",ucuser:t,ucnamespace:6,ucshow:"new",uclimit:"max",ucprop:"title"};return p(e).then(function(t){return t.data.query.usercontribs.map(function(t){return t.title})})}function u(e,o){void 0===o&&(o=3),e=e.replace(/^Category:/,"");var a={language:"commons",project:"wikimedia",categories:e,negcats:"Location_not_applicable","ns[6]":1,depth:o,output_compatability:"catscan",sparse:"on",sortby:"title",format:"json",doit:1};return t.get("https://petscan.wmflabs.org/",{params:a}).then(function(t){return t.data["*"][0].a["*"]})}function p(e){return e=Object.assign({action:"query",format:"json",callback:"JSON_CALLBACK"},e),t.jsonp("https://commons.wikimedia.org/w/api.php",{params:e})}var d=10;return{getCoordinates:i,getCategoriesForPrefix:c,getObjectLocation:s,getFilesForUser:g,getFilesForCategory:u}}var i=o(5),n=o.n(i),l=o(39);e.a=a,a.$inject=["$http","$parse","$sce","$q"]},97:function(t,e,o){"use strict";function a(t){function e(){return t.get("/locator-tool/user").then(function(t){return t.data&&t.data.user})}function o(e,o){var a=e.pageid,i=o.type,n=o.lat,l=o.lng;return t({method:"POST",url:"/locator-tool/edit",data:{type:i,lat:n,lng:l,pageid:a}}).then(function(t){var e=t.data;if(!e.result||!e.result.edit||"Success"!==e.result.edit.result)throw e})}return{getUserInfo:e,editLocation:o}}e.a=a,a.$inject=["$http"]},98:function(t,e,o){"use strict";var a=o(134),i=o.n(a);e.a={template:i.a}},99:function(t,e,o){"use strict";var a=o(135),i=o.n(a),n=function(t){Object.assign(this,{ltDataAuth:t})};n.prototype.editLocation=function(t,e){var o=this;return this.error=void 0,this.ltDataAuth.editLocation(t,e).then(function(){e.markAsSaved()},function(t){o.error=t})},n.$inject=["ltDataAuth"],e.a={bindings:{title:"<"},controller:n,template:i.a}}},[156]);